var OrderForm=function(){function a(){var b;if(!window.c||null==(b=window.c.domainWithProtocol))throw 1;if(this._encodedPromoId=window.c.e,this._formAction=b+"/successful",!window.c||null==(this._queryParams=window.c.queryParams))throw 1}return a.prototype.init=function(){var c=this;document.addEventListener("DOMContentLoaded",function(){c.upgradeForms(),c.listenMessages()})},a.prototype.upgradeForms=function(){try{for(var d=document.getElementsByTagName("form"),e=0;e<d.length;++e){var f=d[e];f.getAttribute("data-upgraded")||(f.elements.name&&(f.elements.phone||f.elements.phoneNumber)?(this.upgradeForm(f),f.setAttribute("data-upgraded","1")):this.reportAnUnknownForm(f))}}catch(g){try{promoRouter.sendError(g.message)}catch(h){}}},a.prototype.listenMessages=function(){var i=this;window.addEventListener("message",function(j){"hideSuccessful"==j.data&&i.hideSuccessful()})},a.prototype.reportAnUnknownForm=function(k){console.error("Unknown form:"),console.error(k)},a.prototype.upgradeForm=function(l){var m=this;l.setAttribute("method","post"),l.setAttribute("action",this._formAction),this.upgradeInput(l.elements.name),this.upgradeInput(l.elements.phone||l.elements.phoneNumber,"tel"),l.getAttribute("data-skip-submit-upgrade")||(l.onsubmit=function(){return m.onSubmit(l)}),this.addHiddenInput(l,"test","yes");var o,n=Object.keys(this._queryParams).reverse();for(o in n){var p=n[o],q=this._queryParams[p];q&&this.addHiddenInput(l,p,q)}var r=l.getElementsByClassName("old-inputs-container")[0];r&&this.prependChild(l,r)},a.prototype.upgradeInput=function(s,t){void 0===t&&(t="text"),s.required=!0,s.type=t,s.maxLength=127,s.setAttribute("onchange","OrderForm.inputValueChanged(this)")},a.inputValueChanged=function(u){u.value=u.value.trim()},a.prototype.onSubmit=function(v,w){var x=this;void 0===w&&(w=null);try{var B,y=v.elements.name,z=v.elements.phone||v.elements.phoneNumber,A=!0;z.value||(this.requireValue(z),A=!1),y.value||(this.requireValue(y),A=!1),A&&((B=new XMLHttpRequest).open("POST",this._formAction+"/default/ajax"+(this._encodedPromoId?"/"+this._encodedPromoId:""),!0),B.onload=function(){return x.onLoad(B,w)},B.onerror=function(){return x.onError(w)},B.send(new FormData(v)))}catch(C){try{promoRouter.sendError(C.message)}catch(D){}}return!1},a.prototype.onLoad=function(E,F){try{var G=JSON.parse(E.responseText);if(!G.isSuccess)return this.onError(F);this.blurAll(),window.onpopstate=null;try{promoRouter.replaceStateInHistory({hardBack:!0},!1),promoRouter.replaceStateInHistory({},!0)}catch(H){}this.showSuccessful(G.url),document.dispatchEvent(new CustomEvent("quality-successful")),F&&F()}catch(I){this.onError(F)}},a.prototype.blurAll=function(){try{var J;document.activeElement instanceof HTMLInputElement&&(J=document.createElement("input"),document.activeElement.parentNode.insertBefore(J,document.activeElement),J.focus(),J.parentNode.removeChild(J))}catch(K){this.onError(callback)}},a.prototype.showSuccessful=function(N){var M=document.createElement("iframe");M.id="successfulFrame",M.src=N,M.setAttribute("style","position: fixed;\n            border: none;\n            top: 0;\n            right: 0;\n            bottom: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            z-index: 9999999;\n            background: white;"),a._originalHtmlStyle=document.documentElement.getAttribute("style")||"",a._originalBodyStyle=document.body.getAttribute("style")||"";N="transform: none;\n            perspective: none;\n            filter: none;\n            will-change: none;";document.documentElement.setAttribute("style",N),document.body.setAttribute("style","margin: 0; padding: 0; overflow: hidden; "+N),document.body.appendChild(M)},a.prototype.hideSuccessful=function(){try{var O=document.getElementById("successfulFrame");O.parentElement.removeChild(O),document.documentElement.setAttribute("style",a._originalHtmlStyle),document.body.setAttribute("style",a._originalBodyStyle)}catch(P){try{promoRouter.sendError(P.message)}catch(Q){}}},a.prototype.onError=function(R){try{promoRouter.sendError("Error while requiring successful page")}catch(S){}alert("Error while requiring successful page"),R&&R()},a.prototype.requireValue=function(T){T.style.WebkitAppearance="none",T.style.WebkitBoxShadow=T.style.MozBoxShadow=T.style.boxShadow="0 0 2px 2px red",setTimeout(function(){T.style.WebkitAppearance=null,T.style.WebkitBoxShadow=T.style.MozBoxShadow=T.style.boxShadow=null},500),T.focus()},a.prototype.addHiddenInput=function(U,V,W){var X=document.createElement("input");X.setAttribute("type","hidden"),X.setAttribute("name",V),X.setAttribute("value",W),this.prependChild(U,X)},a.prototype.prependChild=function(Y,Z){0==Y.childNodes.length?Y.appendChild(Z):Y.insertBefore(Z,Y.childNodes[0])},a}(),orderForm=new OrderForm;orderForm.init();