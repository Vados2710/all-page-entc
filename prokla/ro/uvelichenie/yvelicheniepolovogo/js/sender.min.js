function _typeof(e) { return (_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e })(e) } var REQUIRED_FIELDS = ["phone", "name", "address", "postal_code", "prefecture", "city"], SEND_URL = "/order/create_temporary/", NO_AUTOSAVE_FIELD = "no_autosave_orders", TIMEOUT_PERIOD = 3e3, request_sended = !1, sender = function () { saver.data.forEach((function (e) { var r, t = !0; for (r in e.required) { if (e.required.hasOwnProperty(r) && !e.required[r].is_valid) { t = !1; break } e.form[r] = e.required[r].value } t && !request_sended && (request_sended = !0, $.post(SEND_URL, e.form, (function (e) { "ok" !== e.status && console.log("Error during creating temporary order, error: " + e.message) }), "json")) })) }, timeout = { start: function () { var e; return function () { clearTimeout(e), timeout.stop || (e = setTimeout(sender, TIMEOUT_PERIOD)) } }, stop: !1 }, timeoutResetter = timeout.start(), saver = { data: [], listener: function (e) { request_sended = !1; var r = e.target; saver.data.forEach((function (e, t) { e.required[r.name] && e.required[r.name].value !== r.value && r.value !== e.required[r.name].placeholder && (saver.data[t].required[r.name].value = r.value, saver.data[t].required[r.name].is_valid = !0, timeoutResetter()) })) }, init: function () { var e = $("form"); if (e.length) for (var r = 0; r < e.length; r++) { var t = function (r) { for (var t = e[r], o = { form: {}, required: {} }, n = 0; n < t.elements.length; n++) { var a = t.elements[n]; if (a.name === NO_AUTOSAVE_FIELD && 1 == a.value) return { v: void 0 }; o.form[a.name] = a.value } o.form.user_agent = navigator.userAgent, REQUIRED_FIELDS.forEach((function (e) { var r = t.elements[e]; void 0 !== r && "none" !== r.style.display && "hidden" !== r.type && ($(r).on("keyup", saver.listener), o.required[e] = { value: r.value, is_valid: !1, placeholder: "undefined" !== r.attributes.placeholder ? "" : r.attributes.placeholder.value }) })), o.user_agent = navigator.userAgent, saver.data.push(o) }(r); if ("object" === _typeof(t)) return t.v } } }; $(document).ready((function () { saver.init(), $("form button, form input[type=submit]").click((function () { timeout.stop = !0, timeoutResetter() })) }));