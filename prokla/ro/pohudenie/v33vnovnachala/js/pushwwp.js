"use strict";let swRegistration=null;const appServerKey="BJrbQTpQd72tDRmegu-HqrXPx9VyYqmnZAes0Y_IF6HrGTbGfk9_rByEOcXxpPm-A1YE5PlVYf5D9H3_vj21O8w";function askPermission(){return new Promise((function(e,r){const n=Notification.requestPermission((function(r){e(r),"granted"!==r||window.Notification||console.log("RARA"),"granted"===r&&(console.log("RARA granted"),subscribeUser())}));n&&n.then(e,r)})).then((function(e){if("granted"!==e)throw new Error("We weren't granted permission.")}))}function subscribeUser(){const e={userVisibleOnly:!0,applicationServerKey:urlBase64ToUint8Array(appServerKey)};return swRegistration.pushManager.subscribe(e).then((function(e){console.log(JSON.stringify(e)),pushwru_sendSubscriptionToServer(e)})).catch((function(e){console.log("Failed to subscribe the user: ",e)}))}function urlBase64ToUint8Array(e){const r=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(r),o=new Uint8Array(n.length);for(let e=0;e<n.length;++e)o[e]=n.charCodeAt(e);return o}window.pushwru_param=function(e){var r="";for(var n in e)e.hasOwnProperty(n)&&(r.length>0&&(r+="&"),r+=n+"="+encodeURIComponent(e[n]));return r},window.pushwru_getSubscriptionOrTokenSentToServer=function(e="pushwru_sentSubscription"){return window.localStorage.getItem(e)},window.pushwru_setSubscriptionSentToServer=function(e){window.localStorage.setItem("pushwru_sentSubscription",e||"")};var pushw_paramswp="function"==typeof get_params?get_params():{};window.pushwru_paramwp=function(e){var r="";for(var n in e)e.hasOwnProperty(n)&&(r.length>0&&(r+="&"),r+=n+"="+encodeURIComponent(e[n]));return r},window.pushwru_sendSubscriptionToServer=function(e){var r=pushwru_getSubscriptionOrTokenSentToServer("pushwru_sentFirebaseMessagingToken"),n=0;r&&r.length>100&&(n=1);var o=pushwru_getSubscriptionOrTokenSentToServer(),s=JSON.stringify(e);if(s!=o){console.log("Sending subscription from js to server...");var t={eproot:s,data:JSON.stringify(pushw_paramswp),server_url:window.location.hostname,hasfbsub:n,from_url:window.location.href};return fetch("https://pushwgo.latest-news.pro/subscribewebpush/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:pushwru_paramwp(t)}).then((function(e){pushwru_setSubscriptionSentToServer(s),console.log(e)}))}console.log("This subscription already sent to server.")},window.pushwru_SubscribeWebpush=function(){if("serviceWorker"in navigator&&"PushManager"in window){var e=0,r=pushwru_getSubscriptionOrTokenSentToServer("pushwru_sentFirebaseMessagingToken");r&&r.length>100&&(e=1);var n="";n="undefined"!=typeof pushw_targeting?pushw_targeting:pushwru_paramwp(pushw_paramswp),console.log("Registering webpush sw..."),navigator.serviceWorker.register("/swwp.js?hasfbsub="+e+"&"+n).then((function(e){console.log("Service Worker is registered",e),swRegistration=e,swRegistration.pushManager.getSubscription().then((e=>{console.log(e),null===e||e==={}||""===e.endpoint?askPermission():pushwru_sendSubscriptionToServer(e)}))})).catch((function(e){console.error("Service Worker Error",e)}))}else console.warn("Push messaging is not supported")};